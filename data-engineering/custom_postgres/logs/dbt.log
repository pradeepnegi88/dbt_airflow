

============================== 2024-04-30 16:32:56.387556 | d7b0217f-e2f8-4cf9-a99d-f2d4a90e0360 ==============================
[0m16:32:56.387556 [info ] [MainThread]: Running with dbt=1.4.7
[0m16:32:56.390609 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:32:56.390907 [debug] [MainThread]: Tracking: tracking
[0m16:32:56.404482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf450c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf45780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf45360>]}
[0m16:32:56.413761 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m16:32:56.414720 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:32:56.415166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd7b0217f-e2f8-4cf9-a99d-f2d4a90e0360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf45ea0>]}
[0m16:32:56.831586 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m16:32:56.843142 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m16:32:56.845302 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m16:32:56.847415 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m16:32:56.930580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7b0217f-e2f8-4cf9-a99d-f2d4a90e0360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa67c430>]}
[0m16:32:56.938667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7b0217f-e2f8-4cf9-a99d-f2d4a90e0360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa6a7850>]}
[0m16:32:56.939078 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m16:32:56.939528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7b0217f-e2f8-4cf9-a99d-f2d4a90e0360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa6a7940>]}
[0m16:32:56.941083 [info ] [MainThread]: 
[0m16:32:56.942817 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:32:56.944114 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m16:32:56.951541 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m16:32:56.951810 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m16:32:56.952054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:56.997018 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m16:32:56.998514 [debug] [ThreadPool]: On list_destination_db: Close
[0m16:32:57.001086 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m16:32:57.005223 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m16:32:57.005502 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m16:32:57.005740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:57.014997 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:32:57.015301 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m16:32:57.015567 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:32:57.017186 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m16:32:57.018073 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m16:32:57.018688 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m16:32:57.021935 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:57.022213 [debug] [MainThread]: On master: BEGIN
[0m16:32:57.022474 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:32:57.029884 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:32:57.030176 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:57.030455 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:32:57.032050 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m16:32:57.032985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7b0217f-e2f8-4cf9-a99d-f2d4a90e0360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff912f8e0>]}
[0m16:32:57.033413 [debug] [MainThread]: On master: ROLLBACK
[0m16:32:57.033942 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:57.034174 [debug] [MainThread]: On master: BEGIN
[0m16:32:57.035043 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:32:57.035373 [debug] [MainThread]: On master: COMMIT
[0m16:32:57.035637 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:57.035862 [debug] [MainThread]: On master: COMMIT
[0m16:32:57.036362 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:32:57.036589 [debug] [MainThread]: On master: Close
[0m16:32:57.037097 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:32:57.037494 [info ] [MainThread]: 
[0m16:32:57.049504 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m16:32:57.050017 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m16:32:57.050696 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m16:32:57.051051 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m16:32:57.053176 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m16:32:57.054851 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-04-30 16:32:57.051291 => 2024-04-30 16:32:57.054787
[0m16:32:57.055126 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m16:32:57.083148 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m16:32:57.084811 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m16:32:57.085042 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m16:32:57.085255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:57.093171 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m16:32:57.093459 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m16:32:57.093689 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    select * from "destination_db"."public"."actors"
  );
  
[0m16:32:57.094973 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     select * from "destination_db"."public"."actors"
                          ^

[0m16:32:57.095262 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m16:32:57.096022 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-04-30 16:32:57.055351 => 2024-04-30 16:32:57.095971
[0m16:32:57.096315 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m16:32:57.098140 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     select * from "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m16:32:57.098558 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7b0217f-e2f8-4cf9-a99d-f2d4a90e0360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa65f340>]}
[0m16:32:57.099280 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.05s]
[0m16:32:57.100789 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m16:32:57.101147 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m16:32:57.101560 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m16:32:57.102151 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m16:32:57.102546 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m16:32:57.104711 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m16:32:57.105577 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-04-30 16:32:57.102827 => 2024-04-30 16:32:57.105524
[0m16:32:57.105848 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m16:32:57.108730 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m16:32:57.109374 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m16:32:57.109569 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m16:32:57.109769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:57.119574 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m16:32:57.119867 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m16:32:57.120108 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    select * from "destination_db"."public"."film_actors"
  );
  
[0m16:32:57.120656 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     select * from "destination_db"."public"."film_actors"
                          ^

[0m16:32:57.120863 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m16:32:57.121345 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-04-30 16:32:57.106087 => 2024-04-30 16:32:57.121306
[0m16:32:57.121550 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m16:32:57.122248 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     select * from "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m16:32:57.122692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7b0217f-e2f8-4cf9-a99d-f2d4a90e0360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9132fe0>]}
[0m16:32:57.123093 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.02s]
[0m16:32:57.123443 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m16:32:57.123724 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m16:32:57.124056 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m16:32:57.124645 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m16:32:57.124899 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m16:32:57.126864 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m16:32:57.127643 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-04-30 16:32:57.125099 => 2024-04-30 16:32:57.127609
[0m16:32:57.127878 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m16:32:57.130629 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m16:32:57.131237 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m16:32:57.131426 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m16:32:57.131601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:57.138922 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m16:32:57.139153 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m16:32:57.139346 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    select * from "destination_db"."public"."films"
  );
  
[0m16:32:57.139934 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     select * from "destination_db"."public"."films"
                          ^

[0m16:32:57.140151 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m16:32:57.140652 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-04-30 16:32:57.128063 => 2024-04-30 16:32:57.140612
[0m16:32:57.140845 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m16:32:57.141566 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     select * from "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m16:32:57.141884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7b0217f-e2f8-4cf9-a99d-f2d4a90e0360', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa65e2c0>]}
[0m16:32:57.142265 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.02s]
[0m16:32:57.142650 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m16:32:57.143712 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m16:32:57.144261 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m16:32:57.144651 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m16:32:57.145863 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:32:57.146137 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:57.146368 [debug] [MainThread]: On master: BEGIN
[0m16:32:57.146609 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:32:57.154028 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:32:57.154335 [debug] [MainThread]: On master: COMMIT
[0m16:32:57.154607 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:57.154831 [debug] [MainThread]: On master: COMMIT
[0m16:32:57.155325 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:32:57.155564 [debug] [MainThread]: On master: Close
[0m16:32:57.156039 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:32:57.156296 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m16:32:57.156505 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m16:32:57.156990 [info ] [MainThread]: 
[0m16:32:57.157332 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m16:32:57.157723 [debug] [MainThread]: Command end result
[0m16:32:57.162909 [info ] [MainThread]: 
[0m16:32:57.163304 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m16:32:57.163582 [info ] [MainThread]: 
[0m16:32:57.163871 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m16:32:57.164135 [error] [MainThread]:   relation "public.actors" does not exist
[0m16:32:57.164405 [error] [MainThread]:   LINE 8:     select * from "destination_db"."public"."actors"
[0m16:32:57.164657 [error] [MainThread]:                             ^
[0m16:32:57.164895 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m16:32:57.165151 [info ] [MainThread]: 
[0m16:32:57.165423 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m16:32:57.165671 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m16:32:57.165941 [error] [MainThread]:   LINE 8:     select * from "destination_db"."public"."film_actors"
[0m16:32:57.166174 [error] [MainThread]:                             ^
[0m16:32:57.166431 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m16:32:57.166688 [info ] [MainThread]: 
[0m16:32:57.166947 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m16:32:57.167184 [error] [MainThread]:   relation "public.films" does not exist
[0m16:32:57.167422 [error] [MainThread]:   LINE 8:     select * from "destination_db"."public"."films"
[0m16:32:57.167704 [error] [MainThread]:                             ^
[0m16:32:57.167944 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m16:32:57.168180 [info ] [MainThread]: 
[0m16:32:57.168418 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m16:32:57.168777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa6a77f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf450c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff918fa30>]}
[0m16:32:57.169037 [debug] [MainThread]: Flushing usage events


============================== 2024-04-30 16:47:32.528990 | 22145d9d-357a-40b5-b751-9217bbae5ae9 ==============================
[0m16:47:32.528990 [info ] [MainThread]: Running with dbt=1.4.7
[0m16:47:32.531978 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:47:32.532242 [debug] [MainThread]: Tracking: tracking
[0m16:47:32.545702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf450f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf457b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf45390>]}
[0m16:47:32.556913 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m16:47:32.580848 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m16:47:32.581501 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/actors.sql
[0m16:47:32.581845 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/films.sql
[0m16:47:32.582133 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_actors.sql
[0m16:47:32.628343 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m16:47:32.638440 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m16:47:32.640626 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m16:47:32.687667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22145d9d-357a-40b5-b751-9217bbae5ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff90f3eb0>]}
[0m16:47:32.697010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22145d9d-357a-40b5-b751-9217bbae5ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf5cb50>]}
[0m16:47:32.697440 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m16:47:32.697890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22145d9d-357a-40b5-b751-9217bbae5ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf5c9a0>]}
[0m16:47:32.699611 [info ] [MainThread]: 
[0m16:47:32.701526 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:47:32.702925 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m16:47:32.711557 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m16:47:32.711968 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m16:47:32.712253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:32.757942 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m16:47:32.759580 [debug] [ThreadPool]: On list_destination_db: Close
[0m16:47:32.761821 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m16:47:32.766177 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m16:47:32.766508 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m16:47:32.766802 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:32.775968 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:47:32.776263 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m16:47:32.776528 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:47:32.778031 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m16:47:32.778932 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m16:47:32.779574 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m16:47:32.783163 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:32.783401 [debug] [MainThread]: On master: BEGIN
[0m16:47:32.783592 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:47:32.790852 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:47:32.791104 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:32.791304 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:47:32.793050 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m16:47:32.794198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22145d9d-357a-40b5-b751-9217bbae5ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff913f610>]}
[0m16:47:32.794821 [debug] [MainThread]: On master: ROLLBACK
[0m16:47:32.795752 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:32.796138 [debug] [MainThread]: On master: BEGIN
[0m16:47:32.796950 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:47:32.797271 [debug] [MainThread]: On master: COMMIT
[0m16:47:32.797608 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:32.797858 [debug] [MainThread]: On master: COMMIT
[0m16:47:32.798417 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:47:32.798722 [debug] [MainThread]: On master: Close
[0m16:47:32.799403 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:47:32.799745 [info ] [MainThread]: 
[0m16:47:32.813091 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m16:47:32.813670 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m16:47:32.814441 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m16:47:32.814898 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m16:47:32.817224 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m16:47:32.818438 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-04-30 16:47:32.815140 => 2024-04-30 16:47:32.818376
[0m16:47:32.818728 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m16:47:32.847341 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m16:47:32.848715 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m16:47:32.848970 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m16:47:32.849169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:32.857382 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m16:47:32.857753 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m16:47:32.858044 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m16:47:32.859039 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m16:47:32.859368 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m16:47:32.860241 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-04-30 16:47:32.818947 => 2024-04-30 16:47:32.860174
[0m16:47:32.860604 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m16:47:32.862460 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m16:47:32.862901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22145d9d-357a-40b5-b751-9217bbae5ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa648370>]}
[0m16:47:32.863758 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.05s]
[0m16:47:32.865664 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m16:47:32.866144 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m16:47:32.866658 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m16:47:32.867497 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m16:47:32.867815 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m16:47:32.870206 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m16:47:32.871152 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-04-30 16:47:32.868060 => 2024-04-30 16:47:32.871101
[0m16:47:32.871438 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m16:47:32.874524 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m16:47:32.875444 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m16:47:32.875724 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m16:47:32.875971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:32.884338 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m16:47:32.884635 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m16:47:32.884812 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m16:47:32.885381 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m16:47:32.885688 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m16:47:32.886236 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-04-30 16:47:32.871647 => 2024-04-30 16:47:32.886169
[0m16:47:32.886442 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m16:47:32.887284 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m16:47:32.887665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22145d9d-357a-40b5-b751-9217bbae5ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff910d480>]}
[0m16:47:32.888047 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.02s]
[0m16:47:32.888501 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m16:47:32.888895 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m16:47:32.889405 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m16:47:32.890143 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m16:47:32.890466 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m16:47:32.892732 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m16:47:32.893434 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-04-30 16:47:32.890704 => 2024-04-30 16:47:32.893386
[0m16:47:32.893676 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m16:47:32.896773 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m16:47:32.897388 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m16:47:32.897545 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m16:47:32.897682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:32.906406 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m16:47:32.906712 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m16:47:32.906920 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m16:47:32.907518 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m16:47:32.907820 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m16:47:32.908443 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-04-30 16:47:32.893824 => 2024-04-30 16:47:32.908387
[0m16:47:32.908664 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m16:47:32.909422 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m16:47:32.909738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22145d9d-357a-40b5-b751-9217bbae5ae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa6a90c0>]}
[0m16:47:32.910150 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.02s]
[0m16:47:32.910568 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m16:47:32.911804 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m16:47:32.912291 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m16:47:32.912672 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m16:47:32.914672 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:47:32.915333 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:32.915679 [debug] [MainThread]: On master: BEGIN
[0m16:47:32.916173 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:47:32.930938 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:47:32.931476 [debug] [MainThread]: On master: COMMIT
[0m16:47:32.931774 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:32.932137 [debug] [MainThread]: On master: COMMIT
[0m16:47:32.932961 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:47:32.933803 [debug] [MainThread]: On master: Close
[0m16:47:32.935239 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:47:32.935693 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m16:47:32.935950 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m16:47:32.936474 [info ] [MainThread]: 
[0m16:47:32.937033 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m16:47:32.937677 [debug] [MainThread]: Command end result
[0m16:47:32.944535 [info ] [MainThread]: 
[0m16:47:32.944993 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m16:47:32.945435 [info ] [MainThread]: 
[0m16:47:32.945861 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m16:47:32.946253 [error] [MainThread]:   relation "public.actors" does not exist
[0m16:47:32.946648 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m16:47:32.946976 [error] [MainThread]:                             ^
[0m16:47:32.947364 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m16:47:32.947699 [info ] [MainThread]: 
[0m16:47:32.948000 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m16:47:32.948335 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m16:47:32.948615 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m16:47:32.948926 [error] [MainThread]:                             ^
[0m16:47:32.949275 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m16:47:32.949558 [info ] [MainThread]: 
[0m16:47:32.949928 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m16:47:32.950332 [error] [MainThread]:   relation "public.films" does not exist
[0m16:47:32.950724 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m16:47:32.951010 [error] [MainThread]:                             ^
[0m16:47:32.951300 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m16:47:32.951623 [info ] [MainThread]: 
[0m16:47:32.951955 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m16:47:32.952368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8fb90c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8fb9c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8fb9960>]}
[0m16:47:32.952700 [debug] [MainThread]: Flushing usage events


============================== 2024-04-30 16:54:04.700306 | 099d01e3-1c4a-49d3-91e6-eea7b2f2e1fc ==============================
[0m16:54:04.700306 [info ] [MainThread]: Running with dbt=1.4.7
[0m16:54:04.703611 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:54:04.703931 [debug] [MainThread]: Tracking: tracking
[0m16:54:04.716330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf450f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf457b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf45390>]}
[0m16:54:04.726215 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m16:54:04.751855 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:54:04.752174 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:54:04.757913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '099d01e3-1c4a-49d3-91e6-eea7b2f2e1fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa680a90>]}
[0m16:54:04.767034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '099d01e3-1c4a-49d3-91e6-eea7b2f2e1fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa64a0b0>]}
[0m16:54:04.767378 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m16:54:04.767825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '099d01e3-1c4a-49d3-91e6-eea7b2f2e1fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa64a110>]}
[0m16:54:04.769509 [info ] [MainThread]: 
[0m16:54:04.771320 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:54:04.773395 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m16:54:04.781613 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m16:54:04.781903 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m16:54:04.782132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:04.826734 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m16:54:04.828321 [debug] [ThreadPool]: On list_destination_db: Close
[0m16:54:04.830465 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m16:54:04.834650 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m16:54:04.834924 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m16:54:04.835180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:04.844175 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:54:04.844468 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m16:54:04.844730 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m16:54:04.846233 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m16:54:04.847121 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m16:54:04.847693 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m16:54:04.851042 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:04.851361 [debug] [MainThread]: On master: BEGIN
[0m16:54:04.851585 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:54:04.858837 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:54:04.859137 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:04.859360 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:54:04.861025 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m16:54:04.861831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '099d01e3-1c4a-49d3-91e6-eea7b2f2e1fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa4d38b0>]}
[0m16:54:04.862171 [debug] [MainThread]: On master: ROLLBACK
[0m16:54:04.862698 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:04.862911 [debug] [MainThread]: On master: BEGIN
[0m16:54:04.863674 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:54:04.863912 [debug] [MainThread]: On master: COMMIT
[0m16:54:04.864128 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:04.864333 [debug] [MainThread]: On master: COMMIT
[0m16:54:04.864772 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:54:04.864974 [debug] [MainThread]: On master: Close
[0m16:54:04.865501 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:54:04.865863 [info ] [MainThread]: 
[0m16:54:04.877048 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m16:54:04.877460 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m16:54:04.878082 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m16:54:04.878355 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m16:54:04.880247 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m16:54:04.881338 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-04-30 16:54:04.878570 => 2024-04-30 16:54:04.881282
[0m16:54:04.881588 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m16:54:04.907602 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m16:54:04.908639 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m16:54:04.908875 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m16:54:04.909123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:54:04.917505 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m16:54:04.917838 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m16:54:04.918064 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m16:54:04.918998 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m16:54:04.919231 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m16:54:04.919836 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-04-30 16:54:04.881810 => 2024-04-30 16:54:04.919786
[0m16:54:04.920181 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m16:54:04.921898 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m16:54:04.922295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '099d01e3-1c4a-49d3-91e6-eea7b2f2e1fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa516890>]}
[0m16:54:04.923042 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.04s]
[0m16:54:04.924378 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m16:54:04.924753 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m16:54:04.925144 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m16:54:04.925810 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m16:54:04.926154 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m16:54:04.928722 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m16:54:04.929519 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-04-30 16:54:04.926392 => 2024-04-30 16:54:04.929477
[0m16:54:04.929786 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m16:54:04.932489 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m16:54:04.933253 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m16:54:04.933456 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m16:54:04.933655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:54:04.941376 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m16:54:04.941691 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m16:54:04.941927 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m16:54:04.942487 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m16:54:04.942709 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m16:54:04.943188 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-04-30 16:54:04.929983 => 2024-04-30 16:54:04.943145
[0m16:54:04.943451 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m16:54:04.944128 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m16:54:04.944475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '099d01e3-1c4a-49d3-91e6-eea7b2f2e1fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa538160>]}
[0m16:54:04.944879 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.02s]
[0m16:54:04.945236 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m16:54:04.945523 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m16:54:04.945875 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m16:54:04.946372 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m16:54:04.946606 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m16:54:04.948474 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m16:54:04.949217 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-04-30 16:54:04.946800 => 2024-04-30 16:54:04.949183
[0m16:54:04.949467 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m16:54:04.952272 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m16:54:04.952956 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m16:54:04.953149 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m16:54:04.953341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:54:04.960472 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m16:54:04.960841 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m16:54:04.961088 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m16:54:04.961692 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m16:54:04.961909 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m16:54:04.962368 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-04-30 16:54:04.949680 => 2024-04-30 16:54:04.962327
[0m16:54:04.962577 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m16:54:04.963229 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m16:54:04.963546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '099d01e3-1c4a-49d3-91e6-eea7b2f2e1fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa516da0>]}
[0m16:54:04.963895 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.02s]
[0m16:54:04.964227 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m16:54:04.965573 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m16:54:04.965841 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m16:54:04.966184 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m16:54:04.967162 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:54:04.967383 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:04.967536 [debug] [MainThread]: On master: BEGIN
[0m16:54:04.967678 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:54:04.975338 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:54:04.975637 [debug] [MainThread]: On master: COMMIT
[0m16:54:04.975958 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:04.976192 [debug] [MainThread]: On master: COMMIT
[0m16:54:04.976681 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:54:04.976924 [debug] [MainThread]: On master: Close
[0m16:54:04.977413 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:54:04.977665 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m16:54:04.978107 [info ] [MainThread]: 
[0m16:54:04.978487 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m16:54:04.978966 [debug] [MainThread]: Command end result
[0m16:54:04.984127 [info ] [MainThread]: 
[0m16:54:04.984438 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m16:54:04.984695 [info ] [MainThread]: 
[0m16:54:04.984968 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m16:54:04.985237 [error] [MainThread]:   relation "public.actors" does not exist
[0m16:54:04.985508 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m16:54:04.985786 [error] [MainThread]:                             ^
[0m16:54:04.986079 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m16:54:04.986344 [info ] [MainThread]: 
[0m16:54:04.986611 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m16:54:04.986905 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m16:54:04.987179 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m16:54:04.987427 [error] [MainThread]:                             ^
[0m16:54:04.987671 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m16:54:04.987935 [info ] [MainThread]: 
[0m16:54:04.988181 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m16:54:04.988430 [error] [MainThread]:   relation "public.films" does not exist
[0m16:54:04.988673 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m16:54:04.988951 [error] [MainThread]:                             ^
[0m16:54:04.989200 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m16:54:04.989478 [info ] [MainThread]: 
[0m16:54:04.989746 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m16:54:04.990071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa4d3730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa53add0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa539f30>]}
[0m16:54:04.990344 [debug] [MainThread]: Flushing usage events


============================== 2024-04-30 17:15:29.549151 | fa761870-4393-4978-9f92-a6dfe01ca6d7 ==============================
[0m17:15:29.549151 [info ] [MainThread]: Running with dbt=1.4.7
[0m17:15:29.552169 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:15:29.552592 [debug] [MainThread]: Tracking: tracking
[0m17:15:29.564943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf45360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf457e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf453c0>]}
[0m17:15:29.578318 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m17:15:29.603414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:15:29.603718 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:15:29.609258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa761870-4393-4978-9f92-a6dfe01ca6d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa6849d0>]}
[0m17:15:29.618028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa761870-4393-4978-9f92-a6dfe01ca6d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa649ff0>]}
[0m17:15:29.618381 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m17:15:29.618802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa761870-4393-4978-9f92-a6dfe01ca6d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa64a050>]}
[0m17:15:29.620272 [info ] [MainThread]: 
[0m17:15:29.621976 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:15:29.623931 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m17:15:29.631969 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m17:15:29.632270 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m17:15:29.632540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:29.676337 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m17:15:29.677933 [debug] [ThreadPool]: On list_destination_db: Close
[0m17:15:29.679972 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m17:15:29.684028 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m17:15:29.684297 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m17:15:29.684553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:29.692599 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:15:29.692902 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m17:15:29.693154 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m17:15:29.694680 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m17:15:29.695506 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m17:15:29.696094 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m17:15:29.699298 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:29.699583 [debug] [MainThread]: On master: BEGIN
[0m17:15:29.699817 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:15:29.708441 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:15:29.708731 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:29.708969 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:15:29.710493 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m17:15:29.711324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa761870-4393-4978-9f92-a6dfe01ca6d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa4d7730>]}
[0m17:15:29.711699 [debug] [MainThread]: On master: ROLLBACK
[0m17:15:29.712215 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:29.712449 [debug] [MainThread]: On master: BEGIN
[0m17:15:29.713274 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:15:29.713511 [debug] [MainThread]: On master: COMMIT
[0m17:15:29.713792 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:29.714011 [debug] [MainThread]: On master: COMMIT
[0m17:15:29.714503 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:15:29.714819 [debug] [MainThread]: On master: Close
[0m17:15:29.715310 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:15:29.715633 [info ] [MainThread]: 
[0m17:15:29.726512 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m17:15:29.726904 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m17:15:29.727460 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m17:15:29.727840 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m17:15:29.729668 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m17:15:29.730812 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-04-30 17:15:29.728066 => 2024-04-30 17:15:29.730763
[0m17:15:29.731076 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m17:15:29.756660 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m17:15:29.757765 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m17:15:29.757983 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m17:15:29.758193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:29.765447 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m17:15:29.765685 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m17:15:29.765882 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m17:15:29.766700 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m17:15:29.766906 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m17:15:29.767402 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-04-30 17:15:29.731267 => 2024-04-30 17:15:29.767359
[0m17:15:29.767606 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m17:15:29.769151 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m17:15:29.769555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa761870-4393-4978-9f92-a6dfe01ca6d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa516890>]}
[0m17:15:29.770382 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.04s]
[0m17:15:29.771811 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m17:15:29.772152 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m17:15:29.772541 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m17:15:29.773732 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m17:15:29.774010 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m17:15:29.775764 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m17:15:29.776614 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-04-30 17:15:29.774217 => 2024-04-30 17:15:29.776577
[0m17:15:29.776854 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m17:15:29.779506 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m17:15:29.780122 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m17:15:29.780319 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m17:15:29.780507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:29.787585 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m17:15:29.787890 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m17:15:29.788144 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m17:15:29.788664 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m17:15:29.788975 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m17:15:29.789468 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-04-30 17:15:29.777046 => 2024-04-30 17:15:29.789429
[0m17:15:29.789688 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m17:15:29.790401 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m17:15:29.790900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa761870-4393-4978-9f92-a6dfe01ca6d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa5351e0>]}
[0m17:15:29.791340 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.02s]
[0m17:15:29.791820 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m17:15:29.792176 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m17:15:29.792595 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m17:15:29.793162 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m17:15:29.793412 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m17:15:29.795323 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m17:15:29.796165 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-04-30 17:15:29.793586 => 2024-04-30 17:15:29.796125
[0m17:15:29.796405 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m17:15:29.799188 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m17:15:29.799845 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m17:15:29.800040 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m17:15:29.800247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:29.807546 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m17:15:29.807790 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m17:15:29.808010 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m17:15:29.808500 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m17:15:29.808721 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m17:15:29.809166 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-04-30 17:15:29.796587 => 2024-04-30 17:15:29.809127
[0m17:15:29.809363 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m17:15:29.810031 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m17:15:29.810423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa761870-4393-4978-9f92-a6dfe01ca6d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa685a80>]}
[0m17:15:29.810793 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.02s]
[0m17:15:29.811090 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m17:15:29.812411 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m17:15:29.812688 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m17:15:29.812960 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m17:15:29.813835 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:15:29.814069 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:29.814269 [debug] [MainThread]: On master: BEGIN
[0m17:15:29.814467 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:15:29.823517 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:15:29.823840 [debug] [MainThread]: On master: COMMIT
[0m17:15:29.824083 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:29.824319 [debug] [MainThread]: On master: COMMIT
[0m17:15:29.824823 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:15:29.825076 [debug] [MainThread]: On master: Close
[0m17:15:29.825591 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:15:29.825830 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m17:15:29.826050 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m17:15:29.826560 [info ] [MainThread]: 
[0m17:15:29.826931 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m17:15:29.827324 [debug] [MainThread]: Command end result
[0m17:15:29.832577 [info ] [MainThread]: 
[0m17:15:29.832905 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m17:15:29.833181 [info ] [MainThread]: 
[0m17:15:29.833439 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m17:15:29.833715 [error] [MainThread]:   relation "public.actors" does not exist
[0m17:15:29.833998 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m17:15:29.834276 [error] [MainThread]:                             ^
[0m17:15:29.834531 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m17:15:29.834814 [info ] [MainThread]: 
[0m17:15:29.835165 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m17:15:29.835425 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m17:15:29.835676 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m17:15:29.835924 [error] [MainThread]:                             ^
[0m17:15:29.836129 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m17:15:29.836343 [info ] [MainThread]: 
[0m17:15:29.836549 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m17:15:29.836762 [error] [MainThread]:   relation "public.films" does not exist
[0m17:15:29.836968 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m17:15:29.837163 [error] [MainThread]:                             ^
[0m17:15:29.837351 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m17:15:29.837551 [info ] [MainThread]: 
[0m17:15:29.837792 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m17:15:29.838056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa4be920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa5351e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa536260>]}
[0m17:15:29.838333 [debug] [MainThread]: Flushing usage events


============================== 2024-04-30 17:29:27.988481 | 6dac209e-c51d-49b4-a3ea-51a1d9894225 ==============================
[0m17:29:27.988481 [info ] [MainThread]: Running with dbt=1.4.7
[0m17:29:27.991608 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:29:27.991965 [debug] [MainThread]: Tracking: tracking
[0m17:29:28.006380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf450f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf457b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf45390>]}
[0m17:29:28.018156 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m17:29:28.045216 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:29:28.045605 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:29:28.051513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6dac209e-c51d-49b4-a3ea-51a1d9894225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa680a60>]}
[0m17:29:28.060480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6dac209e-c51d-49b4-a3ea-51a1d9894225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa64a080>]}
[0m17:29:28.060848 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m17:29:28.061307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dac209e-c51d-49b4-a3ea-51a1d9894225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa64a0e0>]}
[0m17:29:28.062980 [info ] [MainThread]: 
[0m17:29:28.065061 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:29:28.067658 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m17:29:28.077969 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m17:29:28.078521 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m17:29:28.078902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:28.111149 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "host.docker.internal" (192.168.65.254), port 5434 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[0m17:29:28.114227 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m17:29:28.114625 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m17:29:28.114942 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m17:29:28.115184 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m17:29:28.115430 [debug] [ThreadPool]: On list_destination_db: No close available on handle
[0m17:29:28.116444 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:29:28.116768 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m17:29:28.117553 [info ] [MainThread]: 
[0m17:29:28.117965 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m17:29:28.118424 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "host.docker.internal" (192.168.65.254), port 5434 failed: server closed the connection unexpectedly
  	This probably means the server terminated abnormally
  	before or while processing the request.
  
[0m17:29:28.118873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa649fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa4d3970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa4d3a60>]}
[0m17:29:28.119169 [debug] [MainThread]: Flushing usage events


============================== 2024-04-30 17:37:25.777013 | b0275454-abf2-4bfe-9fbd-787e168e5a5a ==============================
[0m17:37:25.777013 [info ] [MainThread]: Running with dbt=1.4.7
[0m17:37:25.780086 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:37:25.780477 [debug] [MainThread]: Tracking: tracking
[0m17:37:25.793832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf450f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf457b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf45390>]}
[0m17:37:25.804121 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m17:37:25.832225 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:37:25.832709 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:37:25.839062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0275454-abf2-4bfe-9fbd-787e168e5a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa680a90>]}
[0m17:37:25.852021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0275454-abf2-4bfe-9fbd-787e168e5a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa64a0b0>]}
[0m17:37:25.852518 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m17:37:25.852938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0275454-abf2-4bfe-9fbd-787e168e5a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa64a110>]}
[0m17:37:25.854731 [info ] [MainThread]: 
[0m17:37:25.856900 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:37:25.859069 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m17:37:25.868132 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m17:37:25.868574 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m17:37:25.868860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:25.901698 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "host.docker.internal" (192.168.65.254), port 5434 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[0m17:37:25.904559 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m17:37:25.904923 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m17:37:25.905269 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m17:37:25.905593 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m17:37:25.905867 [debug] [ThreadPool]: On list_destination_db: No close available on handle
[0m17:37:25.906936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:37:25.907191 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m17:37:25.907901 [info ] [MainThread]: 
[0m17:37:25.908292 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m17:37:25.908716 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "host.docker.internal" (192.168.65.254), port 5434 failed: server closed the connection unexpectedly
  	This probably means the server terminated abnormally
  	before or while processing the request.
  
[0m17:37:25.909157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa649ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa4d7970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa4d7a60>]}
[0m17:37:25.909499 [debug] [MainThread]: Flushing usage events


============================== 2024-04-30 18:17:09.932103 | f91241d1-29dc-436f-aad2-9e32267e3e8d ==============================
[0m18:17:09.932103 [info ] [MainThread]: Running with dbt=1.4.7
[0m18:17:09.935480 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:17:09.935748 [debug] [MainThread]: Tracking: tracking
[0m18:17:09.949021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf450f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf457b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf45390>]}
[0m18:17:09.960239 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m18:17:09.983481 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:17:09.983733 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:17:09.989464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f91241d1-29dc-436f-aad2-9e32267e3e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa680a60>]}
[0m18:17:09.998362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f91241d1-29dc-436f-aad2-9e32267e3e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa64a080>]}
[0m18:17:09.998678 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m18:17:09.999163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f91241d1-29dc-436f-aad2-9e32267e3e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa64a0e0>]}
[0m18:17:10.000770 [info ] [MainThread]: 
[0m18:17:10.002746 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:17:10.004956 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m18:17:10.013182 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m18:17:10.013506 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m18:17:10.013848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:10.057813 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m18:17:10.059517 [debug] [ThreadPool]: On list_destination_db: Close
[0m18:17:10.061837 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m18:17:10.066296 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m18:17:10.066618 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m18:17:10.066912 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:10.075236 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:17:10.075604 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m18:17:10.075884 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:17:10.077442 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:17:10.078455 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m18:17:10.079042 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m18:17:10.083529 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:10.083785 [debug] [MainThread]: On master: BEGIN
[0m18:17:10.084004 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:17:10.091539 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:17:10.091868 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:10.092128 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:17:10.094344 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m18:17:10.095226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f91241d1-29dc-436f-aad2-9e32267e3e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa4d7730>]}
[0m18:17:10.095659 [debug] [MainThread]: On master: ROLLBACK
[0m18:17:10.096205 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:10.096634 [debug] [MainThread]: On master: BEGIN
[0m18:17:10.097454 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:17:10.097756 [debug] [MainThread]: On master: COMMIT
[0m18:17:10.097994 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:10.098229 [debug] [MainThread]: On master: COMMIT
[0m18:17:10.098759 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:17:10.099010 [debug] [MainThread]: On master: Close
[0m18:17:10.099577 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:17:10.099978 [info ] [MainThread]: 
[0m18:17:10.113024 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m18:17:10.114124 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m18:17:10.117956 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m18:17:10.119569 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m18:17:10.123271 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m18:17:10.126144 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-04-30 18:17:10.120859 => 2024-04-30 18:17:10.126012
[0m18:17:10.126574 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m18:17:10.156504 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m18:17:10.157990 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m18:17:10.158258 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m18:17:10.158495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:10.166811 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m18:17:10.167137 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m18:17:10.167451 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m18:17:10.168451 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m18:17:10.173103 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m18:17:10.173466 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m18:17:10.174205 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m18:17:10.176228 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m18:17:10.176508 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m18:17:10.177059 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m18:17:10.192263 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m18:17:10.192676 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m18:17:10.192952 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m18:17:10.193897 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m18:17:10.197275 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m18:17:10.197547 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m18:17:10.199055 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m18:17:10.200105 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-04-30 18:17:10.126852 => 2024-04-30 18:17:10.200043
[0m18:17:10.200337 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m18:17:10.200947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f91241d1-29dc-436f-aad2-9e32267e3e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa54aad0>]}
[0m18:17:10.201765 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.08s]
[0m18:17:10.203235 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m18:17:10.203630 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m18:17:10.203991 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m18:17:10.204583 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m18:17:10.204843 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m18:17:10.206831 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m18:17:10.207619 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-04-30 18:17:10.205039 => 2024-04-30 18:17:10.207576
[0m18:17:10.207869 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m18:17:10.210998 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m18:17:10.211841 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m18:17:10.212132 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m18:17:10.212420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:10.221327 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m18:17:10.221643 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m18:17:10.221866 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m18:17:10.222888 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m18:17:10.225002 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m18:17:10.225208 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m18:17:10.225709 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m18:17:10.227577 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m18:17:10.227793 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m18:17:10.228412 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m18:17:10.230096 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m18:17:10.230357 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m18:17:10.230576 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m18:17:10.231351 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m18:17:10.233862 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m18:17:10.234100 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m18:17:10.235208 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m18:17:10.236100 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-04-30 18:17:10.208046 => 2024-04-30 18:17:10.236048
[0m18:17:10.236282 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m18:17:10.236925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f91241d1-29dc-436f-aad2-9e32267e3e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa5ab5e0>]}
[0m18:17:10.237310 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.03s]
[0m18:17:10.237714 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m18:17:10.238002 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m18:17:10.238353 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m18:17:10.238951 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m18:17:10.239213 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m18:17:10.241266 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m18:17:10.241930 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-04-30 18:17:10.239378 => 2024-04-30 18:17:10.241893
[0m18:17:10.242116 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m18:17:10.245034 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m18:17:10.245648 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m18:17:10.245796 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m18:17:10.245956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:10.254394 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m18:17:10.254779 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m18:17:10.255029 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m18:17:10.256098 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m18:17:10.258184 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m18:17:10.258416 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m18:17:10.258883 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m18:17:10.260639 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m18:17:10.260925 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m18:17:10.261543 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m18:17:10.263151 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m18:17:10.263430 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m18:17:10.263642 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m18:17:10.264559 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m18:17:10.266325 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m18:17:10.266581 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m18:17:10.267926 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m18:17:10.268832 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-04-30 18:17:10.242239 => 2024-04-30 18:17:10.268789
[0m18:17:10.269066 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m18:17:10.269667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f91241d1-29dc-436f-aad2-9e32267e3e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa5a8af0>]}
[0m18:17:10.270045 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.03s]
[0m18:17:10.270549 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m18:17:10.272169 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m18:17:10.272493 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m18:17:10.273171 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m18:17:10.273428 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m18:17:10.276041 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m18:17:10.276900 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-04-30 18:17:10.273612 => 2024-04-30 18:17:10.276856
[0m18:17:10.277184 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m18:17:10.280272 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m18:17:10.280976 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m18:17:10.281235 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m18:17:10.281574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:10.290251 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m18:17:10.290532 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m18:17:10.290780 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"  -- Using dbt's ref function to reference the films table
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors  -- Aggregating actor names for each film
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m18:17:10.293257 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m18:17:10.295619 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m18:17:10.295887 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m18:17:10.296579 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m18:17:10.298084 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m18:17:10.298333 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m18:17:10.298551 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m18:17:10.299248 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m18:17:10.300830 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m18:17:10.301046 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m18:17:10.301611 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m18:17:10.303455 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-04-30 18:17:10.277430 => 2024-04-30 18:17:10.303408
[0m18:17:10.303708 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m18:17:10.304295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f91241d1-29dc-436f-aad2-9e32267e3e8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83ca320>]}
[0m18:17:10.304679 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.03s]
[0m18:17:10.305259 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m18:17:10.306613 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:17:10.306916 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:10.307116 [debug] [MainThread]: On master: BEGIN
[0m18:17:10.307295 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:17:10.315694 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:17:10.316145 [debug] [MainThread]: On master: COMMIT
[0m18:17:10.316563 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:10.316908 [debug] [MainThread]: On master: COMMIT
[0m18:17:10.317510 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:17:10.317798 [debug] [MainThread]: On master: Close
[0m18:17:10.318363 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:17:10.318664 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m18:17:10.318956 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m18:17:10.319648 [info ] [MainThread]: 
[0m18:17:10.320118 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m18:17:10.320898 [debug] [MainThread]: Command end result
[0m18:17:10.326961 [info ] [MainThread]: 
[0m18:17:10.327444 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:17:10.327801 [info ] [MainThread]: 
[0m18:17:10.328132 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:17:10.328561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83a8280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83caaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83c8c70>]}
[0m18:17:10.328905 [debug] [MainThread]: Flushing usage events


============================== 2024-04-30 18:21:17.450119 | c8bd104a-8480-4779-bbff-a6bb1001b1f6 ==============================
[0m18:21:17.450119 [info ] [MainThread]: Running with dbt=1.4.7
[0m18:21:17.453318 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:21:17.453617 [debug] [MainThread]: Tracking: tracking
[0m18:21:17.467560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf450f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf457b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf45390>]}
[0m18:21:17.478264 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m18:21:17.504301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:21:17.504654 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:21:17.510939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8bd104a-8480-4779-bbff-a6bb1001b1f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa680a60>]}
[0m18:21:17.519756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8bd104a-8480-4779-bbff-a6bb1001b1f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa64a080>]}
[0m18:21:17.520116 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m18:21:17.520565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8bd104a-8480-4779-bbff-a6bb1001b1f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa64a0e0>]}
[0m18:21:17.522089 [info ] [MainThread]: 
[0m18:21:17.523845 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:21:17.525852 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m18:21:17.534044 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m18:21:17.534352 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m18:21:17.534596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:21:17.578907 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m18:21:17.580671 [debug] [ThreadPool]: On list_destination_db: Close
[0m18:21:17.582911 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m18:21:17.587326 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m18:21:17.587630 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m18:21:17.587900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:21:17.597451 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:21:17.597908 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m18:21:17.598264 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:21:17.599815 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m18:21:17.600697 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m18:21:17.601285 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m18:21:17.604671 [debug] [MainThread]: Using postgres connection "master"
[0m18:21:17.604963 [debug] [MainThread]: On master: BEGIN
[0m18:21:17.605209 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:21:17.614124 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:21:17.614513 [debug] [MainThread]: Using postgres connection "master"
[0m18:21:17.614879 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:21:17.616690 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m18:21:17.617657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8bd104a-8480-4779-bbff-a6bb1001b1f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa4d3730>]}
[0m18:21:17.618084 [debug] [MainThread]: On master: ROLLBACK
[0m18:21:17.618549 [debug] [MainThread]: Using postgres connection "master"
[0m18:21:17.618771 [debug] [MainThread]: On master: BEGIN
[0m18:21:17.619903 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:21:17.620254 [debug] [MainThread]: On master: COMMIT
[0m18:21:17.620512 [debug] [MainThread]: Using postgres connection "master"
[0m18:21:17.620713 [debug] [MainThread]: On master: COMMIT
[0m18:21:17.621200 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:21:17.621431 [debug] [MainThread]: On master: Close
[0m18:21:17.621992 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:21:17.622363 [info ] [MainThread]: 
[0m18:21:17.634420 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m18:21:17.634895 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m18:21:17.635624 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m18:21:17.636130 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m18:21:17.638625 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m18:21:17.639804 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-04-30 18:21:17.636416 => 2024-04-30 18:21:17.639732
[0m18:21:17.640167 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m18:21:17.668579 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m18:21:17.670042 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m18:21:17.670403 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m18:21:17.670645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:21:17.679510 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m18:21:17.679927 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m18:21:17.680300 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m18:21:17.681473 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                          ^

[0m18:21:17.682228 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m18:21:17.683122 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-04-30 18:21:17.640397 => 2024-04-30 18:21:17.683049
[0m18:21:17.683524 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m18:21:17.685684 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "public.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m18:21:17.686366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8bd104a-8480-4779-bbff-a6bb1001b1f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa516890>]}
[0m18:21:17.687342 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.05s]
[0m18:21:17.689138 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m18:21:17.689611 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m18:21:17.690127 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m18:21:17.691607 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m18:21:17.691933 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m18:21:17.693977 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m18:21:17.694879 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-04-30 18:21:17.692182 => 2024-04-30 18:21:17.694830
[0m18:21:17.695211 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m18:21:17.698139 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m18:21:17.699004 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m18:21:17.699244 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m18:21:17.699477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:21:17.707904 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m18:21:17.708199 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m18:21:17.708431 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m18:21:17.708973 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                          ^

[0m18:21:17.709306 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m18:21:17.710033 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-04-30 18:21:17.695432 => 2024-04-30 18:21:17.709972
[0m18:21:17.710348 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m18:21:17.711169 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "public.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m18:21:17.711969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8bd104a-8480-4779-bbff-a6bb1001b1f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa535420>]}
[0m18:21:17.712361 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.02s]
[0m18:21:17.712833 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m18:21:17.713200 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m18:21:17.713696 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m18:21:17.714409 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m18:21:17.714704 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m18:21:17.716946 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m18:21:17.717853 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-04-30 18:21:17.714985 => 2024-04-30 18:21:17.717805
[0m18:21:17.718165 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m18:21:17.721251 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m18:21:17.722015 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m18:21:17.722248 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m18:21:17.722460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:21:17.730846 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m18:21:17.731182 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m18:21:17.731402 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m18:21:17.732017 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."public"."films"
                          ^

[0m18:21:17.732258 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m18:21:17.732957 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-04-30 18:21:17.718402 => 2024-04-30 18:21:17.732859
[0m18:21:17.733264 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m18:21:17.734020 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "public.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."public"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m18:21:17.734475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8bd104a-8480-4779-bbff-a6bb1001b1f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa683010>]}
[0m18:21:17.734875 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.02s]
[0m18:21:17.735249 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m18:21:17.736892 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m18:21:17.737291 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.film_ratings ....................................... [[33mSKIP[0m]
[0m18:21:17.737751 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m18:21:17.738927 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:21:17.739245 [debug] [MainThread]: Using postgres connection "master"
[0m18:21:17.739505 [debug] [MainThread]: On master: BEGIN
[0m18:21:17.739741 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:21:17.749689 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:21:17.750083 [debug] [MainThread]: On master: COMMIT
[0m18:21:17.750335 [debug] [MainThread]: Using postgres connection "master"
[0m18:21:17.750567 [debug] [MainThread]: On master: COMMIT
[0m18:21:17.751128 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:21:17.751388 [debug] [MainThread]: On master: Close
[0m18:21:17.751972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:21:17.752289 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m18:21:17.752554 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m18:21:17.753113 [info ] [MainThread]: 
[0m18:21:17.753629 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m18:21:17.754281 [debug] [MainThread]: Command end result
[0m18:21:17.759977 [info ] [MainThread]: 
[0m18:21:17.760455 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m18:21:17.760852 [info ] [MainThread]: 
[0m18:21:17.761213 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m18:21:17.761568 [error] [MainThread]:   relation "public.actors" does not exist
[0m18:21:17.762232 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."actors"
[0m18:21:17.762587 [error] [MainThread]:                             ^
[0m18:21:17.762929 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m18:21:17.763291 [info ] [MainThread]: 
[0m18:21:17.763566 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m18:21:17.763844 [error] [MainThread]:   relation "public.film_actors" does not exist
[0m18:21:17.764210 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."film_actors"
[0m18:21:17.764525 [error] [MainThread]:                             ^
[0m18:21:17.764877 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m18:21:17.765196 [info ] [MainThread]: 
[0m18:21:17.765533 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m18:21:17.765791 [error] [MainThread]:   relation "public.films" does not exist
[0m18:21:17.766134 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."public"."films"
[0m18:21:17.766452 [error] [MainThread]:                             ^
[0m18:21:17.766715 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m18:21:17.767088 [info ] [MainThread]: 
[0m18:21:17.767467 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m18:21:17.767907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa4bb190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa535420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa536860>]}
[0m18:21:17.768281 [debug] [MainThread]: Flushing usage events


============================== 2024-04-30 18:24:47.715751 | 003fb5f4-55a9-44e1-8bc0-8c30dbb16774 ==============================
[0m18:24:47.715751 [info ] [MainThread]: Running with dbt=1.4.7
[0m18:24:47.718835 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:24:47.719147 [debug] [MainThread]: Tracking: tracking
[0m18:24:47.732078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf45360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf457e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf453c0>]}
[0m18:24:47.742413 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m18:24:47.751665 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:24:47.752238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '003fb5f4-55a9-44e1-8bc0-8c30dbb16774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf44100>]}
[0m18:24:48.168653 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m18:24:48.180519 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m18:24:48.182697 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m18:24:48.184905 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m18:24:48.248659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa6859c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa684220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa6851e0>]}
[0m18:24:48.249045 [debug] [MainThread]: Flushing usage events
[0m18:24:49.486766 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.custom_postgres.films' (models/example/films.sql) depends on a source named 'source_db.films' which was not found


============================== 2024-04-30 18:28:20.912633 | 6fbbbd66-1c6a-4a3b-8d7c-4f8ef4b28028 ==============================
[0m18:28:20.912633 [info ] [MainThread]: Running with dbt=1.4.7
[0m18:28:20.915651 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:28:20.915908 [debug] [MainThread]: Tracking: tracking
[0m18:28:20.927633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf450f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf457b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf45390>]}
[0m18:28:20.938320 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m18:28:20.948024 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:28:20.948507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6fbbbd66-1c6a-4a3b-8d7c-4f8ef4b28028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf44100>]}
[0m18:28:21.365445 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m18:28:21.377459 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m18:28:21.379659 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m18:28:21.381752 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m18:28:21.464577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fbbbd66-1c6a-4a3b-8d7c-4f8ef4b28028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa639810>]}
[0m18:28:21.471956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fbbbd66-1c6a-4a3b-8d7c-4f8ef4b28028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa690160>]}
[0m18:28:21.472518 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m18:28:21.473027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fbbbd66-1c6a-4a3b-8d7c-4f8ef4b28028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa66cf10>]}
[0m18:28:21.474503 [info ] [MainThread]: 
[0m18:28:21.476169 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:28:21.477449 [debug] [ThreadPool]: Acquiring new postgres connection 'list_source_db'
[0m18:28:21.484826 [debug] [ThreadPool]: Using postgres connection "list_source_db"
[0m18:28:21.485116 [debug] [ThreadPool]: On list_source_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_source_db"} */

    select distinct nspname from pg_namespace
  
[0m18:28:21.485396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:28:21.525857 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "host.docker.internal" (192.168.65.254), port 5434 failed: FATAL:  database "source_db" does not exist

[0m18:28:21.534300 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_source_db"} */

    select distinct nspname from pg_namespace
  
[0m18:28:21.534693 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m18:28:21.535020 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m18:28:21.535286 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m18:28:21.535571 [debug] [ThreadPool]: On list_source_db: No close available on handle
[0m18:28:21.536566 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:28:21.536837 [debug] [MainThread]: Connection 'list_source_db' was properly closed.
[0m18:28:21.537527 [info ] [MainThread]: 
[0m18:28:21.537913 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m18:28:21.538338 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "host.docker.internal" (192.168.65.254), port 5434 failed: FATAL:  database "source_db" does not exist
  
[0m18:28:21.538765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf5c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff90ebdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff90ebcd0>]}
[0m18:28:21.539097 [debug] [MainThread]: Flushing usage events


============================== 2024-04-30 18:31:15.327709 | 8028ce2c-f124-4d20-a68e-610c73daa5e5 ==============================
[0m18:31:15.327709 [info ] [MainThread]: Running with dbt=1.4.7
[0m18:31:15.330755 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:31:15.331071 [debug] [MainThread]: Tracking: tracking
[0m18:31:15.343834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf45360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf457e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf453c0>]}
[0m18:31:15.355026 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m18:31:15.364293 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:31:15.364792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8028ce2c-f124-4d20-a68e-610c73daa5e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf44190>]}
[0m18:31:15.784674 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m18:31:15.796785 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m18:31:15.798994 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m18:31:15.801146 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m18:31:15.882380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8028ce2c-f124-4d20-a68e-610c73daa5e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa756740>]}
[0m18:31:15.889841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8028ce2c-f124-4d20-a68e-610c73daa5e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa6937f0>]}
[0m18:31:15.890370 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m18:31:15.890788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8028ce2c-f124-4d20-a68e-610c73daa5e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa670eb0>]}
[0m18:31:15.892286 [info ] [MainThread]: 
[0m18:31:15.894032 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:31:15.895382 [debug] [ThreadPool]: Acquiring new postgres connection 'list_source_db'
[0m18:31:15.902842 [debug] [ThreadPool]: Using postgres connection "list_source_db"
[0m18:31:15.903163 [debug] [ThreadPool]: On list_source_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_source_db"} */

    select distinct nspname from pg_namespace
  
[0m18:31:15.903451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:15.946607 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m18:31:15.948223 [debug] [ThreadPool]: On list_source_db: Close
[0m18:31:15.950465 [debug] [ThreadPool]: Acquiring new postgres connection 'list_source_db_public'
[0m18:31:15.954740 [debug] [ThreadPool]: Using postgres connection "list_source_db_public"
[0m18:31:15.955057 [debug] [ThreadPool]: On list_source_db_public: BEGIN
[0m18:31:15.955317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:31:15.963678 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m18:31:15.963955 [debug] [ThreadPool]: Using postgres connection "list_source_db_public"
[0m18:31:15.964302 [debug] [ThreadPool]: On list_source_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_source_db_public"} */
select
      'source_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'source_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:31:15.965735 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m18:31:15.966699 [debug] [ThreadPool]: On list_source_db_public: ROLLBACK
[0m18:31:15.967205 [debug] [ThreadPool]: On list_source_db_public: Close
[0m18:31:15.971716 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:15.971986 [debug] [MainThread]: On master: BEGIN
[0m18:31:15.972237 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:31:15.980023 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:31:15.980447 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:15.980751 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:31:15.983251 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m18:31:15.984454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8028ce2c-f124-4d20-a68e-610c73daa5e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff90ebfa0>]}
[0m18:31:15.985102 [debug] [MainThread]: On master: ROLLBACK
[0m18:31:15.985836 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:15.986221 [debug] [MainThread]: On master: BEGIN
[0m18:31:15.987236 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:31:15.987679 [debug] [MainThread]: On master: COMMIT
[0m18:31:15.988050 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:15.988353 [debug] [MainThread]: On master: COMMIT
[0m18:31:15.988910 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:31:15.989195 [debug] [MainThread]: On master: Close
[0m18:31:15.989806 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:31:15.990239 [info ] [MainThread]: 
[0m18:31:16.002393 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m18:31:16.003073 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m18:31:16.003853 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m18:31:16.004221 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m18:31:16.006516 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m18:31:16.007988 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-04-30 18:31:16.004475 => 2024-04-30 18:31:16.007901
[0m18:31:16.008546 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m18:31:16.037286 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m18:31:16.038783 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m18:31:16.039061 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m18:31:16.039310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:16.048565 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m18:31:16.049045 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m18:31:16.049439 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "source_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "source_db"."public"."actors"
  );
  
[0m18:31:16.050759 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m18:31:16.056290 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m18:31:16.056661 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "source_db"."public"."actors" rename to "actors__dbt_backup"
[0m18:31:16.057571 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m18:31:16.059874 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m18:31:16.060242 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "source_db"."public"."actors__dbt_tmp" rename to "actors"
[0m18:31:16.060904 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m18:31:16.076145 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m18:31:16.076501 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m18:31:16.076764 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m18:31:16.077756 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m18:31:16.081292 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m18:31:16.081526 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "source_db"."public"."actors__dbt_backup" cascade
[0m18:31:16.082882 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m18:31:16.083833 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-04-30 18:31:16.008858 => 2024-04-30 18:31:16.083788
[0m18:31:16.084069 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m18:31:16.084659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8028ce2c-f124-4d20-a68e-610c73daa5e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9175720>]}
[0m18:31:16.085483 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.08s]
[0m18:31:16.086903 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m18:31:16.087243 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m18:31:16.087575 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m18:31:16.088138 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m18:31:16.088387 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m18:31:16.090256 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m18:31:16.091046 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-04-30 18:31:16.088583 => 2024-04-30 18:31:16.090996
[0m18:31:16.091280 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m18:31:16.094185 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m18:31:16.094803 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m18:31:16.095035 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m18:31:16.095238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:16.102964 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m18:31:16.103279 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m18:31:16.103509 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "source_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "source_db"."public"."film_actors"
  );
  
[0m18:31:16.104468 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m18:31:16.106546 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m18:31:16.106831 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "source_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m18:31:16.107430 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m18:31:16.109352 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m18:31:16.109633 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "source_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m18:31:16.110238 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m18:31:16.111848 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m18:31:16.112128 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m18:31:16.112383 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m18:31:16.113112 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m18:31:16.114591 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m18:31:16.114829 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "source_db"."public"."film_actors__dbt_backup" cascade
[0m18:31:16.116052 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m18:31:16.116865 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-04-30 18:31:16.091453 => 2024-04-30 18:31:16.116825
[0m18:31:16.117082 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m18:31:16.117657 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8028ce2c-f124-4d20-a68e-610c73daa5e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9175390>]}
[0m18:31:16.118078 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.03s]
[0m18:31:16.118489 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m18:31:16.118808 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m18:31:16.119137 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m18:31:16.119732 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m18:31:16.119988 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m18:31:16.122767 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m18:31:16.123522 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-04-30 18:31:16.120168 => 2024-04-30 18:31:16.123481
[0m18:31:16.123753 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m18:31:16.148539 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m18:31:16.149662 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m18:31:16.149928 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m18:31:16.150160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:16.159206 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m18:31:16.159596 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m18:31:16.159899 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "source_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "source_db"."public"."films"
  );
  
[0m18:31:16.161131 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m18:31:16.163312 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m18:31:16.163563 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "source_db"."public"."films" rename to "films__dbt_backup"
[0m18:31:16.164104 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m18:31:16.165923 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m18:31:16.166230 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "source_db"."public"."films__dbt_tmp" rename to "films"
[0m18:31:16.166802 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m18:31:16.168286 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m18:31:16.168522 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m18:31:16.168739 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m18:31:16.169433 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m18:31:16.170883 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m18:31:16.171120 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "source_db"."public"."films__dbt_backup" cascade
[0m18:31:16.172286 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m18:31:16.173195 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-04-30 18:31:16.123940 => 2024-04-30 18:31:16.173150
[0m18:31:16.173514 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m18:31:16.174288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8028ce2c-f124-4d20-a68e-610c73daa5e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9039030>]}
[0m18:31:16.174755 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.05s]
[0m18:31:16.175197 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m18:31:16.176588 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m18:31:16.176906 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m18:31:16.177535 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m18:31:16.177801 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m18:31:16.180405 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m18:31:16.181124 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-04-30 18:31:16.177989 => 2024-04-30 18:31:16.181082
[0m18:31:16.181450 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m18:31:16.184353 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m18:31:16.185071 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m18:31:16.185284 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m18:31:16.185525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:16.193664 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m18:31:16.193967 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m18:31:16.194296 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "source_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "source_db"."public"."films"  -- Using dbt's ref function to reference the films table
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors  -- Aggregating actor names for each film
    FROM "source_db"."public"."films" f
    LEFT JOIN "source_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "source_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m18:31:16.197056 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m18:31:16.199186 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m18:31:16.199425 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "source_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m18:31:16.199962 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m18:31:16.201504 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m18:31:16.201767 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m18:31:16.202003 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m18:31:16.202654 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m18:31:16.204189 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m18:31:16.204415 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "source_db"."public"."film_ratings__dbt_backup" cascade
[0m18:31:16.204886 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m18:31:16.205744 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-04-30 18:31:16.181651 => 2024-04-30 18:31:16.205701
[0m18:31:16.205994 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m18:31:16.206561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8028ce2c-f124-4d20-a68e-610c73daa5e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff914ff10>]}
[0m18:31:16.206978 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.03s]
[0m18:31:16.207407 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m18:31:16.208589 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:31:16.208943 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:16.209185 [debug] [MainThread]: On master: BEGIN
[0m18:31:16.209424 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:31:16.217515 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m18:31:16.217937 [debug] [MainThread]: On master: COMMIT
[0m18:31:16.218313 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:16.218667 [debug] [MainThread]: On master: COMMIT
[0m18:31:16.219306 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m18:31:16.219592 [debug] [MainThread]: On master: Close
[0m18:31:16.220175 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:31:16.220434 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m18:31:16.220916 [info ] [MainThread]: 
[0m18:31:16.221349 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m18:31:16.221903 [debug] [MainThread]: Command end result
[0m18:31:16.228861 [info ] [MainThread]: 
[0m18:31:16.229345 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:31:16.229715 [info ] [MainThread]: 
[0m18:31:16.230052 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:31:16.230491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf5c580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa691450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa6902b0>]}
[0m18:31:16.230818 [debug] [MainThread]: Flushing usage events


============================== 2024-05-01 07:35:34.381241 | f3a698c6-60f9-4b8d-96a1-2ec2e0b18e30 ==============================
[0m07:35:34.381241 [info ] [MainThread]: Running with dbt=1.4.7
[0m07:35:34.384984 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:35:34.385287 [debug] [MainThread]: Tracking: tracking
[0m07:35:34.396894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf45360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf457e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf453c0>]}
[0m07:35:34.407706 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m07:35:34.417450 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m07:35:34.418089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f3a698c6-60f9-4b8d-96a1-2ec2e0b18e30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf44190>]}
[0m07:35:34.836030 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m07:35:34.845442 [debug] [MainThread]: 1603: static parser failed on example/film_ratings.sql
[0m07:35:34.849889 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/film_ratings.sql
[0m07:35:34.851036 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m07:35:34.853246 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m07:35:34.935501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3a698c6-60f9-4b8d-96a1-2ec2e0b18e30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa66b370>]}
[0m07:35:34.943584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3a698c6-60f9-4b8d-96a1-2ec2e0b18e30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf45480>]}
[0m07:35:34.943974 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 293 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m07:35:34.944318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3a698c6-60f9-4b8d-96a1-2ec2e0b18e30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa689e70>]}
[0m07:35:34.945784 [info ] [MainThread]: 
[0m07:35:34.947523 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:35:34.948834 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m07:35:34.956258 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m07:35:34.956532 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m07:35:34.956787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:35:34.999286 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m07:35:35.000826 [debug] [ThreadPool]: On list_destination_db: Close
[0m07:35:35.003069 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m07:35:35.007257 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:35:35.007518 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m07:35:35.007765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:35:35.017278 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m07:35:35.017588 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:35:35.017870 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m07:35:35.019353 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m07:35:35.020473 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m07:35:35.021052 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m07:35:35.025379 [debug] [MainThread]: Using postgres connection "master"
[0m07:35:35.025659 [debug] [MainThread]: On master: BEGIN
[0m07:35:35.025889 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:35:35.033327 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:35:35.033684 [debug] [MainThread]: Using postgres connection "master"
[0m07:35:35.033993 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:35:35.036351 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m07:35:35.037529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3a698c6-60f9-4b8d-96a1-2ec2e0b18e30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa756290>]}
[0m07:35:35.038173 [debug] [MainThread]: On master: ROLLBACK
[0m07:35:35.038866 [debug] [MainThread]: Using postgres connection "master"
[0m07:35:35.039199 [debug] [MainThread]: On master: BEGIN
[0m07:35:35.040056 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:35:35.040341 [debug] [MainThread]: On master: COMMIT
[0m07:35:35.040701 [debug] [MainThread]: Using postgres connection "master"
[0m07:35:35.041078 [debug] [MainThread]: On master: COMMIT
[0m07:35:35.041661 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:35:35.042016 [debug] [MainThread]: On master: Close
[0m07:35:35.042621 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:35:35.043090 [info ] [MainThread]: 
[0m07:35:35.056111 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m07:35:35.056710 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m07:35:35.057528 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m07:35:35.057956 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m07:35:35.060189 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m07:35:35.061391 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-05-01 07:35:35.058187 => 2024-05-01 07:35:35.061335
[0m07:35:35.061664 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m07:35:35.090531 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m07:35:35.092061 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:35:35.092369 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m07:35:35.092627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:35:35.100998 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:35:35.101291 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:35:35.101526 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m07:35:35.102578 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m07:35:35.107886 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:35:35.108206 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m07:35:35.108978 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:35:35.111108 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:35:35.111435 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m07:35:35.112169 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:35:35.126945 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m07:35:35.127243 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:35:35.127495 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m07:35:35.128385 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:35:35.131843 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:35:35.132075 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m07:35:35.133338 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:35:35.134277 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-05-01 07:35:35.061860 => 2024-05-01 07:35:35.134232
[0m07:35:35.134511 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m07:35:35.135141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3a698c6-60f9-4b8d-96a1-2ec2e0b18e30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff917ce50>]}
[0m07:35:35.135939 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.08s]
[0m07:35:35.137406 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m07:35:35.137828 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m07:35:35.138168 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m07:35:35.138718 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m07:35:35.138958 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m07:35:35.140708 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m07:35:35.141477 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-05-01 07:35:35.139127 => 2024-05-01 07:35:35.141440
[0m07:35:35.141750 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m07:35:35.144498 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m07:35:35.145163 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:35:35.145358 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m07:35:35.145552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:35:35.153492 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:35:35.153804 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:35:35.154025 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m07:35:35.154982 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m07:35:35.157025 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:35:35.157241 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m07:35:35.157753 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:35:35.159504 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:35:35.159783 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m07:35:35.160489 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:35:35.161971 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m07:35:35.162236 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:35:35.162468 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m07:35:35.163330 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:35:35.166037 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:35:35.166329 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m07:35:35.167496 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:35:35.168422 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-05-01 07:35:35.141920 => 2024-05-01 07:35:35.168377
[0m07:35:35.168657 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m07:35:35.169253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3a698c6-60f9-4b8d-96a1-2ec2e0b18e30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8fefd60>]}
[0m07:35:35.169700 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.03s]
[0m07:35:35.170277 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m07:35:35.170581 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m07:35:35.170980 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m07:35:35.171553 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m07:35:35.171861 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m07:35:35.173984 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m07:35:35.174758 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-05-01 07:35:35.172034 => 2024-05-01 07:35:35.174715
[0m07:35:35.174978 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m07:35:35.177796 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m07:35:35.178442 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:35:35.178646 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m07:35:35.178862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:35:35.188147 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:35:35.188541 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:35:35.188878 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m07:35:35.189984 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m07:35:35.192187 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:35:35.192420 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m07:35:35.192998 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:35:35.194948 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:35:35.195224 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m07:35:35.195874 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:35:35.197560 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m07:35:35.197860 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:35:35.198241 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m07:35:35.199163 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:35:35.200856 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:35:35.201106 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m07:35:35.202394 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:35:35.203468 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-05-01 07:35:35.175140 => 2024-05-01 07:35:35.203422
[0m07:35:35.203770 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m07:35:35.204452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3a698c6-60f9-4b8d-96a1-2ec2e0b18e30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9003130>]}
[0m07:35:35.204921 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.03s]
[0m07:35:35.205420 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m07:35:35.206847 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m07:35:35.207137 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m07:35:35.207750 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m07:35:35.207989 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m07:35:35.210158 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m07:35:35.210949 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-05-01 07:35:35.208172 => 2024-05-01 07:35:35.210903
[0m07:35:35.211180 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m07:35:35.214178 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m07:35:35.214930 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m07:35:35.215177 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m07:35:35.215460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:35:35.223496 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:35:35.223888 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m07:35:35.224142 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    

WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        
   CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category


     
    FROM "destination_db"."public"."films"  -- Using dbt's ref function to reference the films table
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors  -- Aggregating actor names for each film
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id


  );
  
[0m07:35:35.226518 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m07:35:35.228784 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m07:35:35.229047 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m07:35:35.229693 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:35:35.231131 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m07:35:35.231383 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m07:35:35.231596 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m07:35:35.232204 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:35:35.234478 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m07:35:35.234710 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m07:35:35.235196 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:35:35.236061 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-05-01 07:35:35.211387 => 2024-05-01 07:35:35.236018
[0m07:35:35.236314 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m07:35:35.236858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3a698c6-60f9-4b8d-96a1-2ec2e0b18e30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff903ece0>]}
[0m07:35:35.237269 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.03s]
[0m07:35:35.237784 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m07:35:35.238850 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:35:35.239105 [debug] [MainThread]: Using postgres connection "master"
[0m07:35:35.239314 [debug] [MainThread]: On master: BEGIN
[0m07:35:35.239518 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:35:35.247581 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:35:35.248118 [debug] [MainThread]: On master: COMMIT
[0m07:35:35.248503 [debug] [MainThread]: Using postgres connection "master"
[0m07:35:35.248786 [debug] [MainThread]: On master: COMMIT
[0m07:35:35.249454 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:35:35.249779 [debug] [MainThread]: On master: Close
[0m07:35:35.250350 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:35:35.250630 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m07:35:35.250870 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m07:35:35.251436 [info ] [MainThread]: 
[0m07:35:35.251871 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m07:35:35.252470 [debug] [MainThread]: Command end result
[0m07:35:35.281499 [info ] [MainThread]: 
[0m07:35:35.282057 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:35:35.282464 [info ] [MainThread]: 
[0m07:35:35.282856 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m07:35:35.283325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf8d1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf8f730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd0d6770>]}
[0m07:35:35.283679 [debug] [MainThread]: Flushing usage events


============================== 2024-05-02 08:34:52.650664 | 47539229-b20a-4820-9c7c-24a67ce32940 ==============================
[0m08:34:52.650664 [info ] [MainThread]: Running with dbt=1.4.7
[0m08:34:52.654533 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/opt/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:34:52.654926 [debug] [MainThread]: Tracking: tracking
[0m08:34:52.672605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf450f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf457b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbf45390>]}
[0m08:34:52.691762 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m08:34:52.755003 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:34:52.755796 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:34:52.762724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47539229-b20a-4820-9c7c-24a67ce32940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa685000>]}
[0m08:34:52.776207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47539229-b20a-4820-9c7c-24a67ce32940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa5c6560>]}
[0m08:34:52.776819 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 293 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m08:34:52.777228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47539229-b20a-4820-9c7c-24a67ce32940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa5c65c0>]}
[0m08:34:52.779094 [info ] [MainThread]: 
[0m08:34:52.781013 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:34:52.783621 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m08:34:52.792164 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m08:34:52.792570 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m08:34:52.793207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:34:52.843602 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m08:34:52.845510 [debug] [ThreadPool]: On list_destination_db: Close
[0m08:34:52.848222 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m08:34:52.853135 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m08:34:52.853763 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m08:34:52.854240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:34:52.863664 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m08:34:52.864149 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m08:34:52.864528 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m08:34:52.867112 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m08:34:52.868257 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m08:34:52.868992 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m08:34:52.873922 [debug] [MainThread]: Using postgres connection "master"
[0m08:34:52.874260 [debug] [MainThread]: On master: BEGIN
[0m08:34:52.874542 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:34:52.883712 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m08:34:52.884186 [debug] [MainThread]: Using postgres connection "master"
[0m08:34:52.884528 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:34:52.888964 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m08:34:52.890002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47539229-b20a-4820-9c7c-24a67ce32940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa4cd210>]}
[0m08:34:52.890454 [debug] [MainThread]: On master: ROLLBACK
[0m08:34:52.891131 [debug] [MainThread]: Using postgres connection "master"
[0m08:34:52.891411 [debug] [MainThread]: On master: BEGIN
[0m08:34:52.892337 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m08:34:52.892685 [debug] [MainThread]: On master: COMMIT
[0m08:34:52.893036 [debug] [MainThread]: Using postgres connection "master"
[0m08:34:52.893325 [debug] [MainThread]: On master: COMMIT
[0m08:34:52.893940 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m08:34:52.894237 [debug] [MainThread]: On master: Close
[0m08:34:52.894916 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:34:52.895225 [info ] [MainThread]: 
[0m08:34:52.910300 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m08:34:52.911193 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m08:34:52.912034 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m08:34:52.912672 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m08:34:52.916269 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m08:34:52.918263 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2024-05-02 08:34:52.913370 => 2024-05-02 08:34:52.918174
[0m08:34:52.918632 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m08:34:52.952868 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m08:34:52.954491 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m08:34:52.954760 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m08:34:52.954961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:34:52.963314 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m08:34:52.963570 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m08:34:52.963836 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m08:34:52.965108 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m08:34:52.970137 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m08:34:52.970396 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m08:34:52.971041 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:34:52.972851 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m08:34:52.973058 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m08:34:52.973572 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:34:52.988298 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m08:34:52.988534 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m08:34:52.988725 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m08:34:53.042820 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m08:34:53.046295 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m08:34:53.046481 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m08:34:53.048013 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m08:34:53.049074 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2024-05-02 08:34:52.918899 => 2024-05-02 08:34:53.049025
[0m08:34:53.049257 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m08:34:53.049892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47539229-b20a-4820-9c7c-24a67ce32940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa550b80>]}
[0m08:34:53.050617 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.14s]
[0m08:34:53.051994 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m08:34:53.052336 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m08:34:53.052657 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m08:34:53.053255 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m08:34:53.053447 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m08:34:53.055286 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m08:34:53.057224 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2024-05-02 08:34:53.053588 => 2024-05-02 08:34:53.057184
[0m08:34:53.057424 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m08:34:53.060230 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m08:34:53.061906 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m08:34:53.062048 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m08:34:53.062191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:34:53.069516 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m08:34:53.069870 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m08:34:53.070128 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m08:34:53.071085 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m08:34:53.072988 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m08:34:53.073230 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m08:34:53.073737 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:34:53.075512 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m08:34:53.075753 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m08:34:53.076345 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:34:53.077729 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m08:34:53.077980 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m08:34:53.078186 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m08:34:53.079070 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m08:34:53.081107 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m08:34:53.081301 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m08:34:53.082309 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m08:34:53.083136 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2024-05-02 08:34:53.057554 => 2024-05-02 08:34:53.083106
[0m08:34:53.083358 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m08:34:53.083943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47539229-b20a-4820-9c7c-24a67ce32940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8394040>]}
[0m08:34:53.084321 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.03s]
[0m08:34:53.084754 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m08:34:53.085047 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m08:34:53.085347 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m08:34:53.085881 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m08:34:53.086109 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m08:34:53.087942 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m08:34:53.088665 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2024-05-02 08:34:53.086281 => 2024-05-02 08:34:53.088630
[0m08:34:53.088898 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m08:34:53.091620 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m08:34:53.092288 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m08:34:53.092522 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m08:34:53.092710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:34:53.100407 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m08:34:53.100636 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m08:34:53.100914 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m08:34:53.101899 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m08:34:53.103720 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m08:34:53.103940 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m08:34:53.104396 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:34:53.106123 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m08:34:53.106349 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m08:34:53.106822 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:34:53.108129 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m08:34:53.109383 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m08:34:53.109647 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m08:34:53.110736 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m08:34:53.112226 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m08:34:53.112459 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m08:34:53.113552 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m08:34:53.114376 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2024-05-02 08:34:53.089067 => 2024-05-02 08:34:53.114342
[0m08:34:53.114595 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m08:34:53.115212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47539229-b20a-4820-9c7c-24a67ce32940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa52ce80>]}
[0m08:34:53.115610 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.03s]
[0m08:34:53.116132 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m08:34:53.117658 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m08:34:53.118023 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m08:34:53.118634 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m08:34:53.118902 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m08:34:53.122593 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m08:34:53.124242 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2024-05-02 08:34:53.119072 => 2024-05-02 08:34:53.124199
[0m08:34:53.124473 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m08:34:53.127697 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m08:34:53.128447 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m08:34:53.128670 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m08:34:53.128871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:34:53.136570 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m08:34:53.136845 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m08:34:53.137061 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    

WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        
   CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category


     
    FROM "destination_db"."public"."films"  -- Using dbt's ref function to reference the films table
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors  -- Aggregating actor names for each film
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id


  );
  
[0m08:34:53.139719 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m08:34:53.141846 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m08:34:53.142083 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m08:34:53.142580 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:34:53.144058 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m08:34:53.144284 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m08:34:53.144497 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m08:34:53.151437 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m08:34:53.153860 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m08:34:53.154101 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m08:34:53.154638 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m08:34:53.155566 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2024-05-02 08:34:53.124658 => 2024-05-02 08:34:53.155524
[0m08:34:53.155779 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m08:34:53.156360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47539229-b20a-4820-9c7c-24a67ce32940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83cf5b0>]}
[0m08:34:53.156771 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.04s]
[0m08:34:53.157178 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m08:34:53.158408 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:34:53.158727 [debug] [MainThread]: Using postgres connection "master"
[0m08:34:53.158919 [debug] [MainThread]: On master: BEGIN
[0m08:34:53.159117 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:34:53.166310 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m08:34:53.166503 [debug] [MainThread]: On master: COMMIT
[0m08:34:53.166690 [debug] [MainThread]: Using postgres connection "master"
[0m08:34:53.166952 [debug] [MainThread]: On master: COMMIT
[0m08:34:53.167375 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m08:34:53.167578 [debug] [MainThread]: On master: Close
[0m08:34:53.168025 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:34:53.168244 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m08:34:53.168654 [info ] [MainThread]: 
[0m08:34:53.168961 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m08:34:53.169434 [debug] [MainThread]: Command end result
[0m08:34:53.174649 [info ] [MainThread]: 
[0m08:34:53.175007 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:34:53.175327 [info ] [MainThread]: 
[0m08:34:53.175710 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m08:34:53.176142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83b4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83d0fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83d1330>]}
[0m08:34:53.176452 [debug] [MainThread]: Flushing usage events
